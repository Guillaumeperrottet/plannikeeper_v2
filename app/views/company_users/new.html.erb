<div class="container py-5 d-flex justify-content-center align-items-center min-vh-100">
  <div class="card shadow-lg rounded-4 p-4" style="min-width: 400px; max-width: 500px; width: 100%;">
    <h2 class="mb-4 text-center fw-bold" style="letter-spacing: 1px;">Créer un Nouvel Utilisateur</h2>

    <%= form_with model: @user, url: @user.new_record? ? company_users_path : company_user_path(@user), method: @user.new_record? ? :post : :patch, html: { class: "mt-3" } do |f| %>
      <div class="mb-3">
        <%= f.label :email, "Email", class: "form-label fw-semibold" %>
        <%= f.email_field :email, class: "form-control form-control-lg rounded-pill", style: "width: 100%;", disabled: !@user.new_record?, placeholder: "exemple@email.com" %>
      </div>

      <div class="mb-3">
        <%= f.label :role, "Rôle", class: "form-label fw-semibold" %>
        <%= f.select :role, User.roles.slice('enterprise_user', 'enterprise_admin').keys.map { |role| [role.humanize, role] }, { selected: @user.role || 'enterprise_user' }, class: "form-select rounded-pill" %>
      </div>

      <div class="mb-3">
        <%= f.label :objets, "Objets accessibles", class: "form-label fw-semibold" %>
        <div class="d-flex flex-wrap gap-2">
          <% Objet.where(company_id: current_user.company_id).each do |objet| %>
            <div class="form-check form-switch">
              <%= check_box_tag 'user[objet_ids][]', objet.id, @user.objets.include?(objet), id: "user_objet_#{objet.id}", class: 'form-check-input', style: "cursor:pointer;" %>
              <%= label_tag "user_objet_#{objet.id}", objet.nom, class: 'form-check-label', style: "cursor:pointer;" %>
            </div>
          <% end %>
        </div>
      </div>

      <div class="d-grid mt-4">
        <%= f.submit "Enregistrer", class: "btn btn-primary btn-lg rounded-pill fw-bold shadow-sm" %>
      </div>
    <% end %>
  </div>
</div>
